# åˆ›å»ºå‹è®¾è®¡æ¨¡å¼

## å·¥å‚æ–¹æ³•æ¨¡å¼ ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ

**å®šä¹‰**

å®šä¹‰ä¸€ä¸ªåˆ›å»ºäº§å“å¯¹è±¡çš„å·¥å‚æ¥å£ï¼Œå°†äº§å“å¯¹è±¡çš„å®é™…åˆ›å»ºå·¥ä½œæ¨è¿Ÿåˆ°å…·ä½“å­å·¥å‚ç±»å½“ä¸­



**ä¼˜ç¼ºç‚¹**

+ ä¼˜ç‚¹ï¼š1ï¼‰ç”¨æˆ·çŸ¥é“å…·ä½“å·¥å‚çš„åç§°å°±å¯å¾—åˆ°æ‰€è¦çš„äº§å“ï¼Œæ— é¡»çŸ¥é“äº§å“çš„åˆ›å»ºè¿‡ç¨‹ï¼›2ï¼‰å¢åŠ æ–°çš„äº§å“æ—¶åªéœ€è¦æ·»åŠ å…·ä½“äº§å“ç±»å’Œå¯¹åº”çš„å…·ä½“å·¥å‚ç±»ï¼Œæ— éœ€ä¿®æ”¹æºä»£ç ï¼Œ**æ»¡è¶³å¼€é—­åŸåˆ™**ã€‚

+ ç¼ºç‚¹ï¼šæ¯å¢åŠ ä¸€ä¸ªäº§å“å°±è¦å¢åŠ ä¸€ä¸ªå…·ä½“äº§å“ç±»å’Œä¸€ä¸ªå¯¹åº”çš„å…·ä½“å·¥å‚ç±»ï¼Œè¿™å¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ã€‚

**ç¤ºä¾‹**

```java
//AnimalFarmTest.java
import java.awt.*;
import javax.swing.*;
public class AnimalFarmTest {
	public static void main(String[] args) {
		try
        {
        	Animal a;
        	AnimalFarm af;
        	af=(AnimalFarm) ReadXML2.getObject();
        	a=af.newAnimal();
        	a.show();
        }
        catch(Exception e)
        {
        	System.out.println(e.getMessage());
        }
	}
}
//æŠ½è±¡äº§å“ï¼šåŠ¨ç‰©ç±»
interface Animal {
	public void show();
}
//å…·ä½“äº§å“ï¼šé©¬ç±»
class Horse implements Animal
{
	JScrollPane sp;
    JFrame jf = new JFrame("å·¥å‚æ–¹æ³•æ¨¡å¼æµ‹è¯•");
	public Horse() {
		Container contentPane = jf.getContentPane();
		JPanel p1 = new JPanel();
        p1.setLayout(new GridLayout(1,1));
        p1.setBorder(BorderFactory.createTitledBorder("åŠ¨ç‰©ï¼šé©¬"));
		sp = new JScrollPane(p1);
        contentPane.add(sp, BorderLayout.CENTER);
		JLabel l1 = new JLabel(new ImageIcon("src/chapter03/factoryMethod/A_Horse.jpg"));
		p1.add(l1);		
		jf.pack();        
		jf.setVisible(false);
		jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);//ç”¨æˆ·ç‚¹å‡»çª—å£å…³é—­  
	}
	public void show()
	{
		jf.setVisible(true);
	}
}
//å…·ä½“äº§å“ï¼šç‰›ç±»
class Cattle implements Animal
{
	JScrollPane sp;
    JFrame jf = new JFrame("å·¥å‚æ–¹æ³•æ¨¡å¼æµ‹è¯•");
	public Cattle() {
		Container contentPane = jf.getContentPane();
		JPanel p1 = new JPanel();
        p1.setLayout(new GridLayout(1,1));
        p1.setBorder(BorderFactory.createTitledBorder("åŠ¨ç‰©ï¼šç‰›"));
		sp = new JScrollPane(p1);
        contentPane.add(sp, BorderLayout.CENTER);
		JLabel l1 = new JLabel(new ImageIcon("src/chapter03/factoryMethod/A_Cattle.jpg"));
		p1.add(l1);		
		jf.pack();        
		jf.setVisible(false);
		jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);//ç”¨æˆ·ç‚¹å‡»çª—å£å…³é—­  
	}
	public void show()
	{
		jf.setVisible(true);
	}
}
//æŠ½è±¡å·¥å‚ï¼šç•œç‰§åœº
interface AnimalFarm {
	public Animal newAnimal();
}
//å…·ä½“å·¥å‚ï¼šå…»é©¬åœº
class HorseFarm implements AnimalFarm
{
    public Animal newAnimal()
    {
    	System.out.println("æ–°é©¬å‡ºç”Ÿï¼");
    	return new Horse();
    }
}
//å…·ä½“å·¥å‚ï¼šå…»ç‰›åœº
class CattleFarm implements AnimalFarm
{
    public Animal newAnimal()
    {
    	System.out.println("æ–°ç‰›å‡ºç”Ÿï¼");
    	return new Cattle();
    }
}

//ReadXML2.java
import javax.xml.parsers.*;
import org.w3c.dom.*;
import java.io.*;
class ReadXML2
{
	public static Object getObject()
	{
		try
		{
			DocumentBuilderFactory dFactory = DocumentBuilderFactory.newInstance();
			DocumentBuilder builder = dFactory.newDocumentBuilder();
			Document doc;							
			doc = builder.parse(new File("src/chapter03/factoryMethod/config2.xml")); 
			NodeList nl = doc.getElementsByTagName("className");
            Node classNode=nl.item(0).getFirstChild();
            String cName="chapter03.factoryMethod."+classNode.getNodeValue();
            System.out.println("ÃÃ‚Ã€Ã ÃƒÃ»Â£Âº"+cName);
            Class<?> c=Class.forName(cName);
	  	    Object obj=c.newInstance();
            return obj;
         }   
         catch(Exception e)
         {
           		e.printStackTrace();
           		return null;
         }
	}
}

//config2.xml
<?xml version="1.0" encoding="UTF-8"?>
<config>
	<className>CattleFarm</className>
</config>
```

```java
//FactoryMethodTest.java
public class FactoryMethodTest {
	public static void main(String[] args) {
		try
        {
			Product a;
			AbstractFactory af;
        	af=(AbstractFactory) ReadXML1.getObject();
        	a=af.newProduct();
        	a.show();
        }
        catch(Exception e)
        {
        	System.out.println(e.getMessage());
        }
	}
}
//æŠ½è±¡äº§å“ï¼šæä¾›äº†äº§å“çš„æ¥å£
interface Product {
	public void show();
}
//å…·ä½“äº§å“1ï¼šå®ç°æŠ½è±¡äº§å“ä¸­çš„æŠ½è±¡æ–¹æ³•
class ConcreteProduct1 implements Product
{
	public void show()
	{
		System.out.println("å…·ä½“äº§å“1æ˜¾ç¤º...");
	}
}
//å…·ä½“äº§å“2ï¼šå®ç°æŠ½è±¡äº§å“ä¸­çš„æŠ½è±¡æ–¹æ³•
class ConcreteProduct2 implements Product
{
	public void show()
	{
		System.out.println("å…·ä½“äº§å“2æ˜¾ç¤º...");
	}
}
//æŠ½è±¡å·¥å‚ï¼šæä¾›äº†å‚å“çš„ç”Ÿæˆæ–¹æ³•
interface AbstractFactory {
	public Product newProduct();
}
//å…·ä½“å·¥å‚1ï¼šå®ç°äº†å‚å“çš„ç”Ÿæˆæ–¹æ³•
class ConcreteFactory1 implements AbstractFactory
{
    public Product newProduct()
    {
    	System.out.println("å…·ä½“å·¥å‚1ç”Ÿæˆ-->å…·ä½“äº§å“1...");
    	return new ConcreteProduct1();
    }
}
//å…·ä½“å·¥å‚2ï¼šå®ç°äº†å‚å“çš„ç”Ÿæˆæ–¹æ³•
class ConcreteFactory2 implements AbstractFactory
{
    public Product newProduct()
    {
    	System.out.println("å…·ä½“å·¥å‚2ç”Ÿæˆ-->å…·ä½“äº§å“2...");
    	return new ConcreteProduct2();
    }
}

//FactoryMethodTest.java
import javax.xml.parsers.*;
import org.w3c.dom.*;
import java.io.*;
class ReadXML1
{
//è¯¥æ–¹æ³•ç”¨äºä»XMLé…ç½®æ–‡ä»¶ä¸­æå–å…·ä½“ç±»ç±»åï¼Œå¹¶è¿”å›ä¸€ä¸ªå®ä¾‹å¯¹è±¡
	public static Object getObject()
	{
		try
		{
			//åˆ›å»ºæ–‡æ¡£å¯¹è±¡
			DocumentBuilderFactory dFactory = DocumentBuilderFactory.newInstance();
			DocumentBuilder builder = dFactory.newDocumentBuilder();
			Document doc;							
			doc = builder.parse(new File("src/chapter03/factoryMethod/config1.xml")); 		
			//è·å–åŒ…å«ç±»åçš„æ–‡æœ¬èŠ‚ç‚¹
			NodeList nl = doc.getElementsByTagName("className");
            Node classNode=nl.item(0).getFirstChild();
            String cName="chapter03.factoryMethod."+classNode.getNodeValue();
            //System.out.println("æ–°ç±»åï¼š"+cName);
            //é€šè¿‡ç±»åç”Ÿæˆå®ä¾‹å¯¹è±¡å¹¶å°†å…¶è¿”å›
            Class<?> c=Class.forName(cName);
	  	    Object obj=c.newInstance();
            return obj;
         }   
         catch(Exception e)
         {
           		e.printStackTrace();
           		return null;
         }
	}
}

//config1.xml
<?xml version="1.0" encoding="UTF-8"?>
<config>
	<className>ConcreteFactory2</className>
</config>

```

![](/03.png)

## å•ä¾‹æ¨¡å¼ ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ

**å®šä¹‰**

æŒ‡ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œä¸”è¯¥ç±»èƒ½è‡ªè¡Œåˆ›å»ºè¿™ä¸ªå®ä¾‹çš„ä¸€ç§æ¨¡å¼ã€‚

**ä¼˜ç¼ºç‚¹**

- å•ä¾‹ç±»åªæœ‰ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼›
- **è¯¥å•ä¾‹å¯¹è±¡å¿…é¡»ç”±å•ä¾‹ç±»è‡ªè¡Œåˆ›å»ºï¼›**
- å•ä¾‹ç±»å¯¹å¤–æä¾›ä¸€ä¸ªè®¿é—®è¯¥å•ä¾‹çš„å…¨å±€è®¿é—®ç‚¹ï¼›

**ç¤ºä¾‹**

```java
public class SingletonLazy {
	public static void main(String[] args) {
		President zt1 = President.getInstance();
        zt1.getName();// è¾“å‡ºæ€»ç»Ÿçš„åå­—
        President zt2 = President.getInstance();
        zt2.getName();// è¾“å‡ºæ€»ç»Ÿçš„åå­—
        if (zt1 == zt2) {
           System.out.println("ä»–ä»¬æ˜¯åŒä¸€äººï¼");
        }else {
           System.out.println("ä»–ä»¬ä¸æ˜¯åŒä¸€äººï¼");
        }
	}
}
class President{
    private static volatile President instance=null;//ä¿è¯instanceåœ¨æ‰€æœ‰çº¿ç¨‹ä¸­åŒæ­¥
    private President(){  System.out.println("äº§ç”Ÿä¸€ä¸ªæ€»ç»Ÿï¼"); } //privateé¿å…ç±»åœ¨å¤–éƒ¨è¢«å®ä¾‹åŒ–
    public static synchronized President getInstance(){ //åœ¨getInstanceæ–¹æ³•ä¸ŠåŠ åŒæ­¥
        if(instance==null){
               instance=new President();
        }else {
           System.out.println("å·²ç»æœ‰ä¸€ä¸ªæ€»ç»Ÿï¼Œä¸èƒ½äº§ç”Ÿæ–°æ€»ç»Ÿï¼");
        }
        return instance;
    }
    public void getName() {
        System.out.println("æˆ‘æ˜¯ç¾å›½æ€»ç»Ÿï¼šç‰¹æœ—æ™®ã€‚");
    }
}
```

![](/01.png)

## åŸå‹æ¨¡å¼ ğŸŒŸğŸŒŸ

**å®šä¹‰**

ç”¨ä¸€ä¸ªå·²ç»åˆ›å»ºçš„å®ä¾‹ä½œä¸ºåŸå‹ï¼Œé€šè¿‡**å¤åˆ¶**è¯¥åŸå‹å¯¹è±¡æ¥åˆ›å»ºä¸€ä¸ªå’ŒåŸå‹ç›¸åŒæˆ–ç›¸ä¼¼çš„æ–°å¯¹è±¡

**ä¼˜ç¼ºç‚¹**

åˆ›å»ºå¯¹è±¡éå¸¸é«˜æ•ˆï¼Œæ ¹æœ¬æ— éœ€çŸ¥é“å¯¹è±¡åˆ›å»ºçš„ç»†èŠ‚

**ç¤ºä¾‹**

```java
//åŸå‹æ¨¡å¼çš„æµ‹è¯•ç±»
public class ProtoTypeTest {
	public static void main(String[] args) throws CloneNotSupportedException {
		Realizetype obj1 = new Realizetype();
		Realizetype obj2 = (Realizetype) obj1.clone();
        System.out.println("obj1==obj2 ?"+(obj1==obj2));
	}
}
//å…·ä½“åŸå‹çš„å®ç°ç±»
class Realizetype implements Cloneable{
    Realizetype(){
        System.out.println("å…·ä½“åŸå‹åˆ›å»ºæˆåŠŸï¼");
    }
    public Object clone() throws CloneNotSupportedException{
        System.out.println("å…·ä½“åŸå‹æ‹·è´æˆåŠŸï¼");
        return (Realizetype) super.clone();
    }
}
```

```java
public class ProtoTypeCitation {
	public static void main(String[] args) throws CloneNotSupportedException {
		citation obj1 = new citation("å¼ ä¸‰","åŒå­¦ï¼šåœ¨2016å­¦å¹´ç¬¬ä¸€å­¦æœŸä¸­è¡¨ç°ä¼˜ç§€ï¼Œè¢«è¯„ä¸ºä¸‰å¥½å­¦ç”Ÿã€‚","éŸ¶å…³å­¦é™¢");
		obj1.display();
		citation obj2 = (citation) obj1.clone();
		obj2.setName("æå››");
		obj2.display();
	}
}
//å¥–çŠ¶ç±»
class citation implements Cloneable{
	String name;
    String info;
    String college;
    citation(String name,String info,String college){
    	this.name=name;
        this.info=info;
        this.college=college;
        System.out.println("å¥–çŠ¶åˆ›å»ºæˆåŠŸï¼");
    }
    void setName(String name)
    {
        this.name=name;
    }
    String getName()
    {
        return(this.name);
    }
    void display()
    {
        System.out.println(name+info+college);
    }
    public Object clone() throws CloneNotSupportedException{
        System.out.println("å¥–çŠ¶æ‹·è´æˆåŠŸï¼");
        return (citation) super.clone();
    }
}

```

```java
import java.util.*;
interface Shape extends Cloneable
{
	public Object clone();   //æ‹·è´
	public void countArea(); //è®¡ç®—é¢ç§¯
}
class Circle implements Shape
{
	public Object clone()
	{
		Circle w=null;
		try{ w=(Circle)super.clone(); }
        catch(CloneNotSupportedException e) { System.out.println("æ‹·è´åœ†å¤±è´¥!"); }
		return w;
    }
	public void countArea()
    {
		int r=0;
		System.out.print("è¿™æ˜¯ä¸€ä¸ªåœ†ï¼Œè¯·è¾“å…¥åœ†çš„åŠå¾„ï¼š");
		Scanner input=new Scanner(System.in);
        r=input.nextInt();
		System.out.println("è¯¥åœ†çš„é¢ç§¯="+3.1415*r*r+"\n");
    }
}
class Square implements Shape
{
	public Object clone()
    {
		Square b=null;
        try{  b=(Square)super.clone();   }
        catch(CloneNotSupportedException e) { System.out.println("æ‹·è´æ­£æ–¹å½¢å¤±è´¥!"); }
        return b;
    }
    public void countArea()
    {
    	int a=0;
    	System.out.print("è¿™æ˜¯ä¸€ä¸ªæ­£æ–¹å½¢ï¼Œè¯·è¾“å…¥åœ†çš„è¾¹é•¿ï¼š");
    	Scanner input=new Scanner(System.in);
        a=input.nextInt();
    	System.out.println("è¯¥æ­£æ–¹å½¢çš„é¢ç§¯="+a*a+"\n");
    }
}
class ProtoTypeManager
{
	private HashMap<String, Shape> ht=new HashMap<String, Shape>();
    public ProtoTypeManager()
    {
    	ht.put("Circle",new Circle());
   	    ht.put("Square",new Square());
    }
    public void addshape(String key,Shape obj)
    {
        ht.put(key,obj);
    }
    public Shape getShape(String key)
    {
    	Shape temp=ht.get(key);
    	return (Shape) temp.clone();
    }
}
public class ProtoTypeShape
{
	public static void main(String[] args)
	{
		ProtoTypeManager pm=new ProtoTypeManager();
	    Shape obj1=(Circle)pm.getShape("Circle");
	    obj1.countArea();
	    Shape obj2=(Shape)pm.getShape("Square");
	    obj2.countArea();
	}
}

```

![](/02.png)

## æŠ½è±¡å·¥å‚æ¨¡å¼ ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ

**å®šä¹‰**

æ˜¯ä¸€ç§ä¸ºè®¿é—®ç±»æä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç»„ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œä¸”è®¿é—®ç±»**æ— éœ€æŒ‡å®šæ‰€è¦äº§å“çš„å…·ä½“ç±»å°±èƒ½å¾—åˆ°åŒæ—çš„ä¸åŒç­‰çº§çš„äº§å“çš„æ¨¡å¼ç»“æ„**

**ä¼˜ç¼ºç‚¹**

+ ä¼˜ç‚¹ï¼š1ï¼‰å¯ä»¥åœ¨ç±»çš„å†…éƒ¨å¯¹äº§å“æ—ä¸­ç›¸å…³è”çš„å¤šç­‰çº§äº§å“å…±åŒç®¡ç†ï¼Œè€Œä¸å¿…ä¸“é—¨å¼•å…¥å¤šä¸ªæ–°çš„ç±»æ¥è¿›è¡Œç®¡ç†ï¼›2ï¼‰å½“å¢åŠ ä¸€ä¸ªæ–°çš„äº§å“æ—æ—¶ä¸éœ€è¦ä¿®æ”¹åŸä»£ç ï¼Œ**æ»¡è¶³å¼€é—­åŸåˆ™**ã€‚

+ ç¼ºç‚¹ï¼šå½“äº§å“æ—ä¸­éœ€è¦å¢åŠ ä¸€ä¸ªæ–°ç­‰çº§çš„äº§å“æ—¶ï¼Œåˆ™æ‰€æœ‰çš„å·¥å‚ç±»éƒ½éœ€è¦è¿›è¡Œä¿®æ”¹ã€‚

**ç¤ºä¾‹**

```java
// FarmTest.java
import java.awt.*;
import javax.swing.*;
public class FarmTest {
	public static void main(String[] args) {
		try
        {       	
        	Farm f;
        	Animal a;
        	Plant p;
        	f=(Farm) ReadXML.getObject();
        	a=f.newAnimal();
        	p=f.newPlant();
        	a.show();
        	p.show();
        }
        catch(Exception e)
        {
        	System.out.println(e.getMessage());
        }
	}
}
//æŠ½è±¡äº§å“ï¼šåŠ¨ç‰©ç±»
interface Animal {
	public void show();
}
//å…·ä½“äº§å“ï¼šé©¬ç±»
class Horse implements Animal
{
	JScrollPane sp;
    JFrame jf = new JFrame("æŠ½è±¡å·¥å‚æ¨¡å¼æµ‹è¯•");
	public Horse() {
		Container contentPane = jf.getContentPane();
		JPanel p1 = new JPanel();
        p1.setLayout(new GridLayout(1,1));
        p1.setBorder(BorderFactory.createTitledBorder("åŠ¨ç‰©ï¼šé©¬"));
		sp = new JScrollPane(p1);
        contentPane.add(sp, BorderLayout.CENTER);
		JLabel l1 = new JLabel(new ImageIcon("src/chapter03/abstractFactory/A_Horse.jpg"));
		p1.add(l1);		
		jf.pack();        
		jf.setVisible(false);
		jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);//ç”¨æˆ·ç‚¹å‡»çª—å£å…³é—­  
	}
	public void show()
	{
		jf.setVisible(true);
	}
}
//å…·ä½“äº§å“ï¼šç‰›ç±»
class Cattle implements Animal
{
	JScrollPane sp;
    JFrame jf = new JFrame("æŠ½è±¡å·¥å‚æ¨¡å¼æµ‹è¯•");
	public Cattle() {
		Container contentPane = jf.getContentPane();
		JPanel p1 = new JPanel();
        p1.setLayout(new GridLayout(1,1));
        p1.setBorder(BorderFactory.createTitledBorder("åŠ¨ç‰©ï¼šç‰›"));
		sp = new JScrollPane(p1);
        contentPane.add(sp, BorderLayout.CENTER);
		JLabel l1 = new JLabel(new ImageIcon("src/chapter03/abstractFactory/A_Cattle.jpg"));
		p1.add(l1);		
		jf.pack();        
		jf.setVisible(false);
		jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);//ç”¨æˆ·ç‚¹å‡»çª—å£å…³é—­  
	}
	public void show()
	{
		jf.setVisible(true);
	}
}
//æŠ½è±¡äº§å“ï¼šæ¤ç‰©ç±»
interface Plant {
	public void show();
}
//å…·ä½“äº§å“ï¼šæ°´æœç±»
class Fruitage implements Plant
{
	JScrollPane sp;
    JFrame jf = new JFrame("æŠ½è±¡å·¥å‚æ¨¡å¼æµ‹è¯•");
	public Fruitage() {
		Container contentPane = jf.getContentPane();
		JPanel p1 = new JPanel();
        p1.setLayout(new GridLayout(1,1));
        p1.setBorder(BorderFactory.createTitledBorder("æ¤ç‰©ï¼šæ°´æœ"));
		sp = new JScrollPane(p1);
        contentPane.add(sp, BorderLayout.CENTER);
		JLabel l1 = new JLabel(new ImageIcon("src/chapter03/abstractFactory/P_Fruitage.jpg"));
		p1.add(l1);		
		jf.pack();        
		jf.setVisible(false);
		jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);//ç”¨æˆ·ç‚¹å‡»çª—å£å…³é—­  
	}
	public void show()
	{
		jf.setVisible(true);
	}
}
//å…·ä½“äº§å“ï¼šè”¬èœç±»
class Vegetables implements Plant
{
	JScrollPane sp;
    JFrame jf = new JFrame("æŠ½è±¡å·¥å‚æ¨¡å¼æµ‹è¯•");
	public Vegetables() {
		Container contentPane = jf.getContentPane();
		JPanel p1 = new JPanel();
        p1.setLayout(new GridLayout(1,1));
        p1.setBorder(BorderFactory.createTitledBorder("æ¤ç‰©ï¼šè”¬èœ"));
		sp = new JScrollPane(p1);
        contentPane.add(sp, BorderLayout.CENTER);
		JLabel l1 = new JLabel(new ImageIcon("src/chapter03/abstractFactory/P_Vegetables.jpg"));
		p1.add(l1);		
		jf.pack();        
		jf.setVisible(false);
		jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);//ç”¨æˆ·ç‚¹å‡»çª—å£å…³é—­  
	}
	public void show()
	{
		jf.setVisible(true);
	}
}
//æŠ½è±¡å·¥å‚ï¼šå†œåœºç±»
interface Farm {
	public Animal newAnimal();
	public Plant newPlant();
}
//å…·ä½“å·¥å‚ï¼šéŸ¶å…³å†œåœºç±»
class SGfarm implements Farm
{
    public Animal newAnimal()
    {
    	System.out.println("æ–°ç‰›å‡ºç”Ÿï¼");
    	return new Cattle();
    }
    public Plant newPlant()
    {
    	System.out.println("è”¬èœé•¿æˆï¼");
    	return new Vegetables();
    }
}
//å…·ä½“å·¥å‚ï¼šä¸Šé¥¶å†œåœºç±»
class SRfarm implements Farm
{
    public Animal newAnimal()
    {
    	System.out.println("æ–°é©¬å‡ºç”Ÿï¼");
    	return new Horse();
    }
    public Plant newPlant()
    {
    	System.out.println("æ°´æœé•¿æˆï¼");
    	return new Fruitage();
    }
}

//ReadXML.java
import javax.xml.parsers.*;
import org.w3c.dom.*;
import java.io.*;
class ReadXML
{
	public static Object getObject()
	{
		try
		{
			DocumentBuilderFactory dFactory = DocumentBuilderFactory.newInstance();
			DocumentBuilder builder = dFactory.newDocumentBuilder();
			Document doc;							
			doc = builder.parse(new File("src/chapter03/abstractFactory/config.xml")); 
			NodeList nl = doc.getElementsByTagName("className");
            Node classNode=nl.item(0).getFirstChild();
            String cName="chapter03.abstractFactory."+classNode.getNodeValue();
            System.out.println("ÃÃ‚Ã€Ã ÃƒÃ»Â£Âº"+cName);
            Class<?> c=Class.forName(cName);
	  	    Object obj=c.newInstance();
            return obj;
         }   
         catch(Exception e)
         {
           		e.printStackTrace();
           		return null;
         }
	}
}

//config.xml
<?xml version="1.0" encoding="UTF-8"?>
<config>
	<className>SRfarm</className>
</config>
```

![](/04.png)

## å»ºé€ è€…æ¨¡å¼ ğŸŒŸğŸŒŸ

**å®šä¹‰**

æŒ‡å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„é€ ä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºï¼Œè¿™æ ·çš„è®¾è®¡æ¨¡å¼è¢«ç§°ä¸ºå»ºé€ è€…æ¨¡å¼ã€‚

**ä¼˜ç¼ºç‚¹**

+ ä¼˜ç‚¹ï¼š1ï¼‰å„ä¸ªå…·ä½“çš„å»ºé€ è€…ç›¸äº’ç‹¬ç«‹çš„ï¼Œæœ‰åˆ©äºç³»ç»Ÿçš„æ‰©å±•ï¼›2ï¼‰å®¢æˆ·ç«¯ä¸å¿…çŸ¥é“äº§å“å†…éƒ¨ç»„æˆçš„ç»†èŠ‚ï¼Œä¾¿äºæ§åˆ¶ç»†èŠ‚é£é™©ã€‚

+ ç¼ºç‚¹ï¼š1ï¼‰äº§å“çš„ç»„æˆéƒ¨åˆ†å¿…é¡»ç›¸åŒï¼Œè¿™é™åˆ¶äº†å…¶ä½¿ç”¨èŒƒå›´ï¼›2ï¼‰å¦‚æœäº§å“çš„å†…éƒ¨å˜åŒ–å¤æ‚ï¼Œè¯¥æ¨¡å¼ä¼šå¢åŠ å¾ˆå¤šçš„å»ºé€ è€…ç±»ã€‚

**ç¤ºä¾‹**

```java
// ParlourDecorator.java
import java.awt.*;
import javax.swing.*;
public class ParlourDecorator {
	public static void main(String[] args) {
		try
        {
			Decorator d;
        	d=(Decorator) ReadXML.getObject();
        	ProjectManager m = new ProjectManager(d);        
            Parlour p = m.decorate();
        	p.show();
        }
        catch(Exception e)
        {
        	System.out.println(e.getMessage());
        }
	}
}
//äº§å“ï¼šå®¢å…
class Parlour {
	private String wall; //å¢™
	private String TV;   //ç”µè§†
	private String sofa; //æ²™å‘   
	public void setWall(String wall) {
	    this.wall = wall;
	}
	public void setTV(String TV) {
	    this.TV = TV;
	}
	public void setSofa(String sofa) {
	    this.sofa = sofa;
	}	
	public void show()
	{
		JFrame jf = new JFrame("å»ºé€ è€…æ¨¡å¼æµ‹è¯•");
	    Container contentPane = jf.getContentPane();
	    JPanel p = new JPanel();    
		JScrollPane sp = new JScrollPane(p);   
		String parlour=wall+TV+sofa;
		JLabel l = new JLabel(new ImageIcon("src/chapter03/builder/"+parlour+".jpg"));
		p.setLayout(new GridLayout(1,1));
        p.setBorder(BorderFactory.createTitledBorder("å®¢å…"));
		p.add(l);
		contentPane.add(sp, BorderLayout.CENTER);		
		jf.pack();   
		jf.setVisible(true);
		jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
	}
		
}
//æŠ½è±¡å»ºé€ è€…ï¼šè£…ä¿®å·¥äºº
abstract class Decorator {
	//åˆ›å»ºäº§å“å¯¹è±¡
  protected  Parlour product=new Parlour();
  public  abstract void buildWall();
  public  abstract void buildTV();
  public  abstract void buildSofa();
  //è¿”å›äº§å“å¯¹è±¡
  public  Parlour getResult() {
         return  product;
  }
}
//å…·ä½“å»ºé€ è€…ï¼šå…·ä½“è£…ä¿®å·¥äºº1
class ConcreteDecorator1  extends Decorator{
	public void buildWall() {
		product.setWall("w1");
	}
	public void buildTV() {
		product.setTV("TV1");
	}
	public void buildSofa() {
		product.setSofa("sf1");
	}
}
//å…·ä½“å»ºé€ è€…ï¼šå…·ä½“è£…ä¿®å·¥äºº2
class ConcreteDecorator2  extends Decorator{
	public void buildWall() {
		product.setWall("w2");
	  }
	  public void buildTV() {
		  product.setTV("TV2");
	  }
	  public void buildSofa() {
		  product.setSofa("sf2");
	  }
}
//æŒ‡æŒ¥è€…ï¼šé¡¹ç›®ç»ç†
class ProjectManager {
	private Decorator builder;
  public ProjectManager(Decorator builder) {
  	this.builder=builder;
  }
  //äº§å“æ„å»ºä¸ç»„è£…æ–¹æ³•
  public Parlour decorate() {
  	builder.buildWall();
      builder.buildTV();
      builder.buildSofa();
      return builder.getResult();
  }
}

//ReadXML.java
import javax.xml.parsers.*;
import org.w3c.dom.*;
import java.io.*;
class ReadXML
{
	public static Object getObject()
	{
		try
		{
			DocumentBuilderFactory dFactory = DocumentBuilderFactory.newInstance();
			DocumentBuilder builder = dFactory.newDocumentBuilder();
			Document doc;							
			doc = builder.parse(new File("src/chapter03/builder/config.xml")); 
			NodeList nl = doc.getElementsByTagName("className");
            Node classNode=nl.item(0).getFirstChild();
            String cName="chapter03.builder."+classNode.getNodeValue();
            System.out.println("ÃÃ‚Ã€Ã ÃƒÃ»Â£Âº"+cName);
            Class<?> c=Class.forName(cName);
	  	    Object obj=c.newInstance();
            return obj;
         }   
         catch(Exception e)
         {
           		e.printStackTrace();
           		return null;
         }
	}
}

//config.xml
<?xml version="1.0" encoding="UTF-8"?>
<config>
	<className>ConcreteDecorator2</className>
</config>
```

![](/05.png)
