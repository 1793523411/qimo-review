# 设备管理

## 设备管理的基本概念

I/O 管理的功能:完成用户提出的 I/O 请求，提高 I/O 速率以及改善 I/O 设备的利用率,设备控制、设备分配、缓冲区管理、设备驱动调度、虚拟设备等

设备独立性:所谓设备独立性是指，用户在程序中使用的设备与实际使用的设备无关，也就是在用户程序中仅使用逻辑设备名

设备独立性的优点:

- 方便用户
- 改善设备利用率
- 提高系统的可扩展性和可适应性

设备控制块(DCB ) :系统为每一台设备都配置了一个用来记录设备的硬件特性、连接和使用情况的一组数据，称为设备控制块

## 缓冲技术

什么是缓冲?

缓冲是两种不同速度的设备之间传输信息时平滑传输过程的常用手段

引入缓冲的目的:

① 为了缓和 CPU 和 I/O 设备速度不匹配的矛盾，提高 CPU 和 I/O 设备的并行性

② 缓冲区数据成批传入内存，减少对 CPU 的中断频率，放宽对 CPU 中断响应时间的限制

③ 提高 CPU 和 I/O 设备之间的并行性

常用的缓冲技术 : 双缓冲、环形缓冲、缓冲池

双缓冲技术:

![](/os2-18.png)
![](/os2-19.png)

## 设备分配

常用的设备分配技术 :独享分配,共享分配,虚拟分配

独享设备:让一个作业在整个运行期间独占使用的设备

独享分配:在一个作业执行前，将它所要使用的设备分配给它；当它结束撤离时，将分配给它的这类设备收回

共享设备:由多个作业、进程共同使用的设备称为共享设备

共享分配:在进程运行的过程中进行的，当进程需要使用设备时，通过系统调用命令向系统提出设备请求，系统按一定的分配策略给进程分配所需设备，一旦使用完毕立即释放。显然这种分配方式有利于提高设备的使用效率，但会出观死锁

虚拟设备:通常把用来代替独占型设备的那部分外存空间 (包括有关的控制表格)称为虚拟设备

虚拟技术:所谓虚拟技术，是在一类物理设备上模拟另一类物理设备的技术，是将独占设备转化为共享设备的技术

虚拟分配：当进程需要与独占型设备交换信息时，系统将分配磁盘空间，并建立相应的数据结构，这种分配方法称为设备的虚拟分配。

Spooling 系统：利用通道和中断技术，在主机控制之下，由通道完成输入输出工作。系统提供一个软件系统 (包括预输入程序、缓输出程序、井管理程序、预输入表、缓输出表)。它提供输入收存和输出发送的功能，使外部设备可以并行操作。这一软件系统称为 SPOOLING 系统

SPOOLING 系统用于实现虚拟设备

SPOOLING 系统的优点：

① 提供虚拟设备

② 外围设备同时联机操作

③ 加快作业处理速度

## I/O 控制

CPU 通过 I/O 控制器与物理设备打交道。按照 I/O 控制器智能化程度的高低，将 I/O 设备的控制方式分为四类：

+ 循环测试 I/O 方式（程序 I/O 方式）
+ I/O 中断方式
+ DMA 方式
+ 通道方式

**请求 I/O 的进程、I/O 过程、设备处理进程、中断处理程序之间的同步关系**

![](/os2-20.png)

## 要点

虚拟设备是指：通过虚拟技术将一台独占设备改造成若干台逻辑设备，供若干个用户进程同时使用。

通道是：负责I/O的处理机

字节多路通道主要用作：连接大量的低速I/O设备。

根据信息交换方式的不同，可以将通道分为：字节多路通道、数据选择通道、数据多路通道

设备独立性是指：应用程序独立于具体使用的物理设备。

缓冲技术中的缓冲池在：主存中。

如果有多个中断同时发生，系统将根据中断优先级响应优先级最高的中断请求。若要调整中断事件的响应次序，可以利用：中断屏蔽

在操作系统中，一种用空间换取时间的资源转换技术是:Spooling。

大多数低速设备都属于：独占设备。

为了实现CPU与外设的并行工作，系统引入了:中断和通道硬件机制。

在操作系统中，用户在使用I/O设备时，通常采用:逻辑设备名

Spooling系统是由：磁盘中的输入井和输出井、内存中的输入缓冲区和输出缓冲区以及输入进程和输出进程组成
