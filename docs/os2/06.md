# 处理机调度

处理机调度分为两级：作业调度和进程调度

## 作业调度

- 按一定的原则对外存上处于后备状态的作业进行选择，给选中的作业分配内存、输入/输出设备等必要的资源，并建立相应的进程，插入就绪队列，以使该作的进程获得竞争处理机的权利
- 主要用于批处理系统中

### 作业的状态

- 后备状态：作业已存放在磁盘上，等待作业调度。
- 执行状态：作业进入主存开始运行。
- 完成状态：作业计算完成开始，退出系统

![](/os2-15.png)

### 周转时间、带权周转时间的定义 ,物理意义

**采用平均周转时间和平均带权周转时间衡量作业调度算法 性能的好坏**

周转时间:一个作业提交给计算机系统到该作业的结果返回给用户所需要的时间,意义：说明作业 i 在系统中停留时间的长短。

带权周转时间: 一个作业的周转时间与其运行时间的比值，意义：说明作业 i 在系统中相对等待时间。

### 常用的作业调度算法：先来先服务 ,短作业优先

调度算法的设计目标：

- 具有公平性
- 资源利用率高（特别是 CPU 利用率）
- 在交互式系统情况下要追求响应时间（越短越好）
- 在批处理系统情况下要追求系统吞吐量
- 在实时系统中要保证截止时间

#### 先来先服务

策略：按作业来到的先后次序进行调度。

特点： 简单，易实现。

讨论：先来先服务调度算法的周转时间与带权周转时间

![](/os2-16.jpg)

#### 短作业优先

策略：按作业请求运行的时间长短进行调度。

特点： 易实现，系统吞吐量高。

讨论：短作业优先调度算法的周转时间与带权周转时间

![](/os2-17.jpg)

## 进程调度

- 主要任务是按照某种策略和方法选取一个处于就绪状态的进程，将处理机分配给它。
- 所有类型操作系统都需要支持进程调度。

调度方式:当一进程正在处理机上执行时，若有某个更为“重要而紧迫”的进程需要运行，系统如何分配处理机。

非剥夺方式:让正在执行的进程继续执行，直到该进程完成或发生某事件而进入“完成”或“阻塞”状态时，才把处理机分配给“重要而紧迫”的进程

剥夺方式:当“重要而紧迫”的进程一到，便暂停正在执行的进程，立即把处理机分配给优先级更高的进程。

### 常用的进程调度算法

#### 进程优先数调度算法

预先确定各进程的优先数，系统把处理机的使用权赋予就绪队列中具备最高优先权(优先数和一定的优先级相对应)的就绪进程。

静态优先数 —— 在进程被创建时确定，且一经确定后在整个进程运行期间不再改变。

静态优先数的确定

- 优先数根据进程所需使用的资源来计算
- 优先数基于程序运行时间的估计
- 优先数基于进程的类型

动态优先数 —— 进程优先数在进程运行期间可以改变。

动态优先数的确定

- 进程使用 CPU 超过一定数值时，降低优先数
- 进程 I/O 操作后，增加优先数
- 进程等待时间超过一定数值时，提高优先数

#### 循环轮转调度算法

当 CPU 空闲时，选取就绪队列首元素，赋予一个时间片当时间片用完时，该进程转为就绪态并进入就绪队列末端。

![](/os2-18.jpg)

**简单循环轮转调度算法**

简单循环轮转调度算法的就绪队列是一个单队列结构，就绪队列中的所有进程以等速度向前进展。

- 可变时间片轮转调度
- 多重时间片循环调度

### 调度用的进程状态变迁图的分析

![](/os2-16.png)

- 进程状态 —— 运行 高优先就绪, 低优先就绪, 因 I∕O 而等待
- 队列结构 —— 高优先就绪队列, 低优先就绪队列 ,因 I∕O 而等待队列
- 进程调度算法
  - 优先调度与时间片调度相结合的调度算法
  - (1) 当 CPU 空闲时，若高优先就绪队列非空，则从高优先就绪队列中选择一个进程运行，分配时间片为 100ms。
  - (2) 当 CPU 空闲时，若高优先就绪队列为空，则从低优先就绪队列中选择一个进程运行，分配时间片为 500ms。
- 调度效果
  - 优先照顾了 I∕O 量大的进程；适当照顾了计算量大的进程
